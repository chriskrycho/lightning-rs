<html>
                            <head>
                                <link rel="stylesheet" href="/light.css" media="(prefers-color-scheme: light)" />
                                <link rel="stylesheet" href="/dark.css" media="(prefers-color-scheme: dark)" />
                            </head>
                            <body>
                                <p>Idiomatic Ember Octane avoids using Ember’s classic <code>Mixin</code> and <code>ObjectProxy</code> types. However, a very common pattern in many Ember Classic apps and addons was to use Ember’s <code>PromiseProxyObject</code> mixin in conjunction with <code>ObjectProxy</code> to expose the state of a promise to end users, and to make accessing the resolved data more convenient. Migrating an app from Ember Classic to be <em>idiomatic</em> Ember Octane means replacing all of that with something more Octane-friendly.</p>
<p>In this post, we will cover how to rewrite code that uses promise proxy mixing into a lightweight, auto-tracked, Octane-ready, future-friendly solution—and hint at a new to think about asynchronous data in a new way, as well!￼</p>
<ul>
<li><a href="#a-direct-migration">A direct migration</a></li>
<li><a href="#alternative-less-js-more-template">Alternative: less JS, more template</a></li>
<li><a href="#alternative-less-template-more-js">Alternative: less template, more JS</a></li>
<li><a href="#summary">Summary</a></li>
</ul>
<h2>A direct migration</h2>
<p>We’ll start with a utility that allows us to create a proxy at will, <code>createPromiseProxy</code>:</p>
<pre><code class='JavaScript'><span class="source js"><span class="comment line double-slash js"><span class="punctuation definition comment js">//</span> my-app/utils/object-promise-proxy.js
</span><span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">ObjectProxy</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@ember/object/proxy<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>
<span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">PromiseProxyMixin</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@ember/object/promise-proxy-mixin<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>

<span class="storage type js">const</span> <span class="variable other readwrite js">ObjectPromiseProxy</span> <span class="keyword operator assignment js">=</span> <span class="variable other object js">ObjectProxy</span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">extend</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="variable other readwrite js">PromiseProxyMixin</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>

<span class="meta export js"><span class="keyword control import-export js">export</span> <span class="variable other readwrite js">function</span> </span><span class="meta function-call js"><span class="variable function js">createPromiseProxy</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="variable other readwrite js">promise</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span> <span class="meta block js"><span class="punctuation section block js">{</span>
  <span class="keyword control flow js">return</span> <span class="variable other object js">ObjectPromiseProxy</span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">create</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="meta object-literal js"><span class="punctuation section block js">{</span> <span class="variable other readwrite js">promise</span> <span class="punctuation section block js">}</span></span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>
<span class="punctuation section block js">}</span></span>
</span></code></pre>
<p>Then we might use it in a component that looks like this:<sup class="footnote-reference"><a href="#jquery">1</a></sup></p>
<pre><code class='JavaScript'><span class="source js"><span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">Component</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@glimmer/component<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>
<span class="meta import js"><span class="keyword control import-export js">import</span> <span class="meta block js"><span class="punctuation section block js">{</span> <span class="variable other readwrite js">createPromiseProxy</span> <span class="punctuation section block js">}</span></span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>my-app/utils/object-promise-proxy.js<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>

<span class="storage type js">const</span> <span class="variable other constant js">USERS_API</span> <span class="keyword operator assignment js">=</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>example.com/users<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation terminator statement js">;</span>

<span class="meta export js"><span class="keyword control import-export js">export</span> <span class="keyword control import-export js">default</span> <span class="meta class js"><span class="storage type class js">class</span> <span class="entity name class js">SmartComponent</span> <span class="storage modifier extends js">extends</span> <span class="entity other inherited-class js">Component</span> <span class="meta class js"><span class="meta block js"><span class="punctuation section block js">{</span></span></span></span><span class="meta class js"><span class="meta block js">
  <span class="meta function declaration js"><span class="storage type accessor js">get</span> <span class="entity name function js">userData</span><span class="punctuation section group begin js">(</span><span class="punctuation section group end js">)</span><span class="meta function declaration js"> </span></span><span class="meta block js"><span class="punctuation section block js">{</span>
    <span class="storage type js">let</span> <span class="support module node js">url</span> <span class="keyword operator assignment js">=</span> <span class="meta instance constructor js"><span class="keyword operator word new js">new</span><span class="meta function-call constructor js"> <span class="variable type js">URL</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="variable other constant js">USERS_API</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span></span><span class="punctuation terminator statement js">;</span>
    <span class="support module node js">url</span><span class="punctuation accessor js">.</span><span class="meta property object js">searchParams</span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">append</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>id<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation separator comma js">,</span> <span class="variable language this js">this</span><span class="punctuation accessor js">.</span><span class="meta property object js">args</span><span class="punctuation accessor js">.</span><span class="meta property object js">id</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>

    <span class="keyword control flow js">return</span> <span class="meta function-call js"><span class="variable function js">createPromiseProxy</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="meta function-call js"><span class="variable function js">fetch</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="support module node js">url</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">then</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="meta function declaration js"><span class="punctuation section group begin js">(</span><span class="variable parameter function js">data</span><span class="punctuation section group end js">)</span><span class="meta function declaration js"> </span><span class="storage type function arrow js">=&gt;</span></span> <span class="meta block js"><span class="variable other object js">data</span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">json</span><span class="meta group js"><span class="punctuation section group js">(</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span></span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>
  <span class="punctuation section block js">}</span></span>
<span class="punctuation section block js">}</span></span></span></span>
</span></code></pre>
<p>:::note</p>
<p>Here we’re relying on the fact that <code>args</code> are auto-tracked: this getter consumes <code>this.args.id</code>, so it’ll rerun any time the component is invoked with a new <code>id</code>. In a classic Ember component, you might see <code>@computed('id')</code> to update whenever the <code>id</code> argument updated.</p>
<p>:::</p>
<p>We would invoke the component something like this (presumably with a more dynamic source of the ID):</p>
<pre><code>&lt;SmartComponent @id={{1234}} /&gt;
</code></pre>
<p>The body of the component might look like this:</p>
<pre><code>{{#if this.userData.isFulfilled}}
  {{this.userData.userName}}
{{else if this.userData.isRejected}}
  Whoops, something went wrong!
{{/if}}
</code></pre>
<p>To migrate away from this, we can use a composition-based approach instead of a mixin/inheritance-based approach. I’m going to use a <code>load</code> helper and associated <code>AsyncData</code> structure (<a href="https://gist.github.com/chriskrycho/306a82990dd82203073272e055df5cd1">defined here</a>). I plan to write a post explaining the underlying ideas for that helper in the future. For now, it’s enough to know the following things:</p>
<ul>
<li>
<p>The helper can be used with any value, <code>Promise</code> or not.</p>
</li>
<li>
<p>It can be used in templates <em>or</em> imported and used in JavaScript.</p>
</li>
<li>
<p>It returns an <code>AsyncData</code>, which has the following public properties:</p>
<ul>
<li><code>state</code>, which can be <code>'LOADING'</code>, <code>'LOADED'</code>, or <code>'ERROR'</code></li>
<li><code>isLoading</code></li>
<li><code>isError</code></li>
<li><code>value</code>, which is either the resolved value if the promise has resolved or <code>undefined</code> if it’s still pending or has rejected</li>
<li><code>error</code>, which is either the promise rejection value if the promise rejected or <code>undefined</code> if the promise is still pending or has resolved successfully</li>
</ul>
</li>
</ul>
<p>Using it looks pretty similar to using the component with the promise proxy mixin—we’ve just replaced the <code>createPromiseProxy</code> call with the <code>load</code> call:</p>
<pre><code class='JavaScript'><span class="source js"><span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">Component</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@glimmer/component<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>
<span class="meta import js"><span class="keyword control import-export js">import</span> <span class="meta block js"><span class="punctuation section block js">{</span> <span class="variable other readwrite js">load</span> <span class="punctuation section block js">}</span></span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>my-app/helpers/load<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>

<span class="storage type js">const</span> <span class="variable other constant js">USERS_API</span> <span class="keyword operator assignment js">=</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>http://www.example.com/users<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation terminator statement js">;</span>

<span class="meta export js"><span class="keyword control import-export js">export</span> <span class="keyword control import-export js">default</span> <span class="meta class js"><span class="storage type class js">class</span> <span class="entity name class js">SmartComponent</span> <span class="storage modifier extends js">extends</span> <span class="entity other inherited-class js">Component</span> <span class="meta class js"><span class="meta block js"><span class="punctuation section block js">{</span></span></span></span><span class="meta class js"><span class="meta block js">
  <span class="meta function declaration js"><span class="storage type accessor js">get</span> <span class="entity name function js">userData</span><span class="punctuation section group begin js">(</span><span class="punctuation section group end js">)</span><span class="meta function declaration js"> </span></span><span class="meta block js"><span class="punctuation section block js">{</span>
    <span class="storage type js">let</span> <span class="support module node js">url</span> <span class="keyword operator assignment js">=</span> <span class="meta instance constructor js"><span class="keyword operator word new js">new</span><span class="meta function-call constructor js"> <span class="variable type js">URL</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="variable other constant js">USERS_API</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span></span><span class="punctuation terminator statement js">;</span>
    <span class="support module node js">url</span><span class="punctuation accessor js">.</span><span class="meta property object js">searchParams</span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">append</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>id<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation separator comma js">,</span> <span class="variable language this js">this</span><span class="punctuation accessor js">.</span><span class="meta property object js">args</span><span class="punctuation accessor js">.</span><span class="meta property object js">id</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>
    
    <span class="keyword control flow js">return</span> <span class="meta function-call js"><span class="variable function js">load</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="meta function-call js"><span class="variable function js">fetch</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="support module node js">url</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">then</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="meta function declaration js"><span class="punctuation section group begin js">(</span><span class="variable parameter function js">data</span><span class="punctuation section group end js">)</span><span class="meta function declaration js"> </span><span class="storage type function arrow js">=&gt;</span></span> <span class="meta block js"><span class="variable other object js">data</span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">json</span><span class="meta group js"><span class="punctuation section group js">(</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span></span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>
  <span class="punctuation section block js">}</span></span>
<span class="punctuation section block js">}</span></span></span></span>
</span></code></pre>
<p>Invoking it would be identical; the only change is in the corresponding template:</p>
<pre><code>{{#if this.userData.isLoaded}}
  {{this.userData.value.userName}}
{{else if this.userData.isError}}
  Whoops, something went wrong!
{{/if}}
</code></pre>
<p>The actual changes here are small:</p>
<ul>
<li>There’s one extra <code>.value</code> intermediate value lookup: <code>this.userData.value.userName</code> instead of <code>this.userData.userName</code>. (This is the result of <em>composing</em> the data instead of <em>inheriting</em> it.)</li>
<li>The names of the <em>state</em> values are different: <code>isLoaded</code> and <code>isError</code> instead of <code>isFulfilled</code> and <code>isRejected</code>.</li>
</ul>
<p>And with that, we’ve successfully gotten away from <code>PromiseProxyMixin</code> in our app code!</p>
<h2>Alternative: less JS, more template</h2>
<p>We could also do more of this template-side, since the <code>load</code> tool is both a utility function and a helper. In that case, here’s how the component would look:</p>
<pre><code class='JavaScript'><span class="source js"><span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">Component</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@glimmer/component<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>

<span class="storage type js">const</span> <span class="variable other constant js">USERS_API</span> <span class="keyword operator assignment js">=</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>http://www.example.com/users<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation terminator statement js">;</span>

<span class="meta export js"><span class="keyword control import-export js">export</span> <span class="keyword control import-export js">default</span> <span class="meta class js"><span class="storage type class js">class</span> <span class="entity name class js">SmartComponent</span> <span class="storage modifier extends js">extends</span> <span class="entity other inherited-class js">Component</span> <span class="meta class js"><span class="meta block js"><span class="punctuation section block js">{</span></span></span></span><span class="meta class js"><span class="meta block js">
  <span class="meta function declaration js"><span class="storage type accessor js">get</span> <span class="entity name function js">userData</span><span class="punctuation section group begin js">(</span><span class="punctuation section group end js">)</span><span class="meta function declaration js"> </span></span><span class="meta block js"><span class="punctuation section block js">{</span>
    <span class="storage type js">let</span> <span class="support module node js">url</span> <span class="keyword operator assignment js">=</span> <span class="meta instance constructor js"><span class="keyword operator word new js">new</span><span class="meta function-call constructor js"> <span class="variable type js">URL</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="variable other constant js">USERS_API</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span></span><span class="punctuation terminator statement js">;</span>
    <span class="support module node js">url</span><span class="punctuation accessor js">.</span><span class="meta property object js">searchParams</span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">append</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>id<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation separator comma js">,</span> <span class="variable language this js">this</span><span class="punctuation accessor js">.</span><span class="meta property object js">args</span><span class="punctuation accessor js">.</span><span class="meta property object js">id</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>
    
    <span class="keyword control flow js">return</span> <span class="meta function-call js"><span class="variable function js">fetch</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="support module node js">url</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>
  <span class="punctuation section block js">}</span></span>
<span class="punctuation section block js">}</span></span></span></span>
</span></code></pre>
<p>The template would use the <code>load</code> helper with the resulting promise in the template, by invoking it with <a href="https://api.emberjs.com/ember/3.20/classes/Ember.Templates.helpers">the <code>let</code> helper</a>:</p>
<pre><code>{{#let (load this.userData) as |result|}}
  {{#if result.isLoaded}}
    {{result.value.userName}}
  {{else if result.isError}}
    Whoops, something went wrong!
  {{/if}}
{{/let}}
</code></pre>
<h2>Alternative: less template, more JS</h2>
<p>Because the <code>load</code> utility and its <code>AsyncData</code> type use auto-tracking, we can freely do things with the resulting data type in our JavaScript, too. For example, if we wanted to pull <em>all</em> the logic into a new component which just accepts an <code>AsyncData</code> for the user profile, we could do that. Assume we had our original <code>load</code>-using component version, which has <code>this.userData</code> as an <code>AsyncData</code>. We could pass it to another component like so:</p>
<pre><code>&lt;RenderUser @userData={{this.userData}} /&gt;
</code></pre>
<p>Then we could make the <code>RenderUser</code> component’s template be extremely simple:</p>
<pre><code>&lt;div&gt;{{this.content}}&lt;/div&gt;
</code></pre>
<p>The <code>content</code> could be specified via a getter on the backing class:</p>
<pre><code class='JavaScript'><span class="source js"><span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">Component</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@glimmer/component<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>

<span class="meta export js"><span class="keyword control import-export js">export</span> <span class="keyword control import-export js">default</span> <span class="meta class js"><span class="storage type class js">class</span> <span class="entity name class js">RenderUser</span> <span class="storage modifier extends js">extends</span> <span class="entity other inherited-class js">Component</span> <span class="meta class js"><span class="meta block js"><span class="punctuation section block js">{</span></span></span></span><span class="meta class js"><span class="meta block js">
  <span class="meta function declaration js"><span class="storage type accessor js">get</span> <span class="entity name function js">content</span><span class="punctuation section group begin js">(</span><span class="punctuation section group end js">)</span><span class="meta function declaration js"> </span></span><span class="meta block js"><span class="punctuation section block js">{</span>
    <span class="meta switch js"><span class="keyword control switch js">switch</span> <span class="meta group js"><span class="punctuation section group js">(</span><span class="variable language this js">this</span><span class="punctuation accessor js">.</span><span class="meta property object js">args</span><span class="punctuation accessor js">.</span><span class="meta property object js">userData</span><span class="punctuation accessor js">.</span><span class="meta property object js">state</span><span class="punctuation section group js">)</span></span> <span class="meta block js"><span class="punctuation section block js">{</span>
      <span class="keyword control switch js">case</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>LOADED<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation separator js">:</span> <span class="meta block js"><span class="punctuation section block js">{</span>
        <span class="storage type js">let</span> <span class="variable other readwrite js">user</span> <span class="keyword operator assignment js">=</span> <span class="variable language this js">this</span><span class="punctuation accessor js">.</span><span class="meta property object js">args</span><span class="punctuation accessor js">.</span><span class="meta property object js">userData</span><span class="punctuation accessor js">.</span><span class="meta property object js">value</span><span class="punctuation terminator statement js">;</span>
        <span class="keyword control flow js">return</span> <span class="string template js"><span class="punctuation definition string template begin js">`</span></span><span class="meta template expression js"><span class="punctuation definition template-expression begin js">${</span></span><span class="meta template expression js"><span class="source js embedded expression"><span class="variable other object js">user</span><span class="punctuation accessor js">.</span><span class="meta property object js">name</span></span><span class="punctuation definition template-expression end js">}</span></span><span class="string template js"> is </span><span class="meta template expression js"><span class="punctuation definition template-expression begin js">${</span></span><span class="meta template expression js"><span class="source js embedded expression"><span class="variable other object js">user</span><span class="punctuation accessor js">.</span><span class="meta property object js">age</span></span><span class="punctuation definition template-expression end js">}</span></span><span class="string template js"> years old!<span class="punctuation definition string template end js">`</span></span><span class="punctuation terminator statement js">;</span>
      <span class="punctuation section block js">}</span></span>
      <span class="keyword control switch js">case</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>LOADING<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation separator js">:</span>
        <span class="keyword control flow js">return</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>Loading...<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation terminator statement js">;</span>
      <span class="keyword control switch js">case</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>ERROR<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation separator js">:</span>
      <span class="keyword control switch js">default</span><span class="punctuation separator js">:</span>
        <span class="keyword control flow js">return</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>Something went wrong. 😱 Please try again!<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation terminator statement js">;</span>
    </span><span class="meta block js"><span class="punctuation section block js">}</span></span></span>
  <span class="punctuation section block js">}</span></span>
<span class="punctuation section block js">}</span></span></span></span>
</span></code></pre>
<p>Again, we’re taking advantage of <code>args</code> being auto-tracked: if we ever got a <em>different</em> <code>AsyncData</code> passed in as <code>userData</code>, we would update to the correct version of that. Likewise, because the <code>state</code> and <code>data</code> properties of the <code>AsyncData</code> type are tracked, this getter will recompute any time either of those is updated as well.</p>
<h2>Summary</h2>
<p>We do have to type <code>.value</code> in a couple of places now… but in exchange, we get all the benefits of the old <code>PromiseProxyMixin</code> in exchange, and we get to get rid of a <code>Mixin</code> <em>and</em> a use of Ember’s classic (and very expensive for performance) <code>ObjectProxy</code>, which is yet another <code>Mixin</code>. What’s more, there’s no magic here. You can implement <code>load</code> yourself in plain JavaScript using the Glimmer tracking library, just the same as I did!</p>
<p>:::callout</p>
<p>Feel free to respond with questions or comments <a href="https://discuss.emberjs.com/t/migrating-off-of-promiseproxymixin-in-ember-octane/18138/2">on Ember Discuss</a>. And if you’re curious about how <code>load</code> and <code>AsyncData</code> work, check out <a href="https://v5.chriskrycho.com/journal/async-data-and-autotracking-in-ember-octane/">the follow-up post</a>!</p>
<p>:::</p>
<div class="footnote-definition" id="jquery"><sup class="footnote-definition-label">1</sup>
<p>Ember’s API guides for <code>PromiseProxyMixin</code> give an example very similar to this, but with less context and more jQuery. I’ve replaced the use of jQuery’s <code>$.getJSON</code> with <code>fetch</code> and <code>Body.json()</code>, and used arrow functions instead of <code>function</code> declarations; I’ve also embedded it in an example component to make the ideas a bit clearer.</p>
</div>

                            </body>
                        </html>