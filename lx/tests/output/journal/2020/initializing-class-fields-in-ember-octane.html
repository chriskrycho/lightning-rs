<html>
                            <head>
                                <link rel="stylesheet" href="/light.css" media="(prefers-color-scheme: light)" />
                                <link rel="stylesheet" href="/dark.css" media="(prefers-color-scheme: dark)" />
                            </head>
                            <body>
                                <p>Long-time <a href="https://emberjs.com">Ember.js</a> developers have often internalized the idea that any initialization should happen explicitly in Ember classic classes’ <code>init</code> hook, and <em>not</em> directly in the plain old JavaScript object (POJO) which defines the classic class.</p>
<p>Bad classic code:</p>
<pre><code class='JavaScript'><span class="source js"><span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">Component</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@ember/component<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>

<span class="meta export js"><span class="keyword control import-export js">export</span> <span class="keyword control import-export js">default</span> <span class="variable other object js">Component</span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">extend</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="meta object-literal js"><span class="punctuation section block js">{</span>
  <span class="meta object-literal key js">someData</span><span class="punctuation separator key-value js">:</span> <span class="meta sequence js"><span class="punctuation section brackets js">[</span><span class="punctuation section brackets js">]</span></span><span class="punctuation separator comma js">,</span>
<span class="punctuation section block js">}</span></span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span>
</span></span></code></pre>
<p>Good classic code:</p>
<pre><code class='JavaScript'><span class="source js"><span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">Component</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@ember/component<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>
<span class="meta import js"><span class="keyword control import-export js">import</span> <span class="meta block js"><span class="punctuation section block js">{</span> <span class="variable other readwrite js">set</span> <span class="punctuation section block js">}</span></span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@ember/object<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>

<span class="meta export js"><span class="keyword control import-export js">export</span> <span class="keyword control import-export js">default</span> <span class="variable other object js">Component</span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">extend</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="meta object-literal js"><span class="punctuation section block js">{</span>
  <span class="meta function declaration js"><span class="entity name function js">init</span><span class="punctuation section group begin js">(</span><span class="punctuation section group end js">)</span><span class="meta function declaration js"> </span></span><span class="meta block js"><span class="punctuation section block js">{</span>
    <span class="variable language this js">this</span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">_super</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="keyword operator spread js">...</span><span class="variable language arguments js">arguments</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>
    <span class="meta function-call js"><span class="variable function js">set</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="variable language this js">this</span><span class="punctuation separator comma js">,</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>someData<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation separator comma js">,</span> <span class="meta sequence js"><span class="punctuation section brackets js">[</span><span class="punctuation section brackets js">]</span></span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>
  <span class="punctuation section block js">}</span></span>
<span class="punctuation section block js">}</span></span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span>
</span></span></code></pre>
<p>This is because of how classic classes worked: the values passed into the POJO were set on the <a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Object_prototypes">prototype</a> for the class, and so were shared between all instances of the class. That meant that when you passed an array literal as part of the POJO, like <code>someData: []</code>, that same array would be shared between <em>all</em> instances of the component. This is <em>almost never</em> what you want, so developers learned (and <a href="https://github.com/ember-cli/eslint-plugin-ember">Ember’s official lint rule set</a> enforced!) that any reference types like objects or arrays be set in <code>init</code>.</p>
<p>When working with native classes, though, class fields are <em>not</em> set on the prototype, but on the instance. That means that you can just define values directly as class fields, because this—</p>
<pre><code class='JavaScript'><span class="source js"><span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">Component</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@glimmer/component<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>

<span class="meta export js"><span class="keyword control import-export js">export</span> <span class="keyword control import-export js">default</span> <span class="meta class js"><span class="storage type class js">class</span> <span class="entity name class js">MyComponent</span> <span class="storage modifier extends js">extends</span> <span class="entity other inherited-class js">Component</span> <span class="meta class js"><span class="meta block js"><span class="punctuation section block js">{</span></span></span></span><span class="meta class js"><span class="meta block js">
  someData = [];
<span class="punctuation section block js">}</span></span></span></span>
</span></code></pre>
<p>—is the same as writing this:</p>
<pre><code class='JavaScript'><span class="source js"><span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">Component</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@glimmer/component<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>

<span class="meta export js"><span class="keyword control import-export js">export</span> <span class="keyword control import-export js">default</span> <span class="meta class js"><span class="storage type class js">class</span> <span class="entity name class js">MyComponent</span> <span class="storage modifier extends js">extends</span> <span class="entity other inherited-class js">Component</span> <span class="meta class js"><span class="meta block js"><span class="punctuation section block js">{</span></span></span></span><span class="meta class js"><span class="meta block js">
  someData;
  
  <span class="meta function declaration js"><span class="entity name function js">constructor</span><span class="punctuation section group begin js">(</span><span class="punctuation section group end js">)</span><span class="meta function declaration js"> </span></span><span class="meta block js"><span class="punctuation section block js">{</span>
    <span class="meta function-call js"><span class="support function js">super</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="keyword operator spread js">...</span><span class="variable language arguments js">arguments</span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>

    <span class="support class builtin js">Object</span><span class="punctuation accessor js">.</span><span class="meta function-call method js"><span class="variable function js">defineProperty</span><span class="meta group js"><span class="punctuation section group js">(</span><span class="variable language this js">this</span><span class="punctuation separator comma js">,</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>someData<span class="punctuation definition string end js">&#39;</span></span><span class="punctuation separator comma js">,</span> <span class="meta object-literal js"><span class="punctuation section block js">{</span>
      <span class="meta object-literal key js">enumerable</span><span class="punctuation separator key-value js">:</span> <span class="constant language boolean true js">true</span><span class="punctuation separator comma js">,</span>
      <span class="meta object-literal key js">configurable</span><span class="punctuation separator key-value js">:</span> <span class="constant language boolean true js">true</span><span class="punctuation separator comma js">,</span>
      <span class="meta object-literal key js">writable</span><span class="punctuation separator key-value js">:</span> <span class="constant language boolean true js">true</span><span class="punctuation separator comma js">,</span>
      <span class="meta object-literal key js">value</span><span class="punctuation separator key-value js">:</span> <span class="meta sequence js"><span class="punctuation section brackets js">[</span><span class="punctuation section brackets js">]</span></span><span class="punctuation separator comma js">,</span>
    <span class="punctuation section block js">}</span></span></span><span class="meta group js"><span class="punctuation section group js">)</span></span></span><span class="punctuation terminator statement js">;</span>
  <span class="punctuation section block js">}</span></span>
<span class="punctuation section block js">}</span></span></span></span>
</span></code></pre>
<p>:::note</p>
<p>Here I’ve switched to the <code>@glimmer/component</code> base class to use <code>constructor</code> instead of <code>init</code>, but the idea is the same!</p>
<p>:::</p>
<p>For day-to-day purposes, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty">that <code>Object.defineProperty</code> call</a> is basically the same as just doing the assignment in the constructor.<sup class="footnote-reference"><a href="#differences">1</a></sup> The net of this is that you can leave behind your long-standing habits of doing assignment in the <code>constructor</code> where you’re just setting up a default value for a class field. The <em>only</em> time you should prefer to do things in the <code>constructor</code> is when it depends on the other state of the class—in other words, when it references <code>this</code> in some way. If it <em>doesn’t</em> refer to <code>this</code>, though, even things like instantiating utility classes can just happen in class field assignment:</p>
<pre><code class='JavaScript'><span class="source js"><span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">Component</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>@glimmer/component<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>
<span class="meta import js"><span class="keyword control import-export js">import</span> <span class="variable other readwrite js">Formatter</span> <span class="keyword control import-export js">from</span> <span class="string quoted single js"><span class="punctuation definition string begin js">&#39;</span>../utils/formatter<span class="punctuation definition string end js">&#39;</span></span></span><span class="punctuation terminator statement js">;</span>

<span class="meta export js"><span class="keyword control import-export js">export</span> <span class="keyword control import-export js">default</span> <span class="meta class js"><span class="storage type class js">class</span> <span class="entity name class js">MyComponent</span> <span class="storage modifier extends js">extends</span> <span class="entity other inherited-class js">Component</span> <span class="meta class js"><span class="meta block js"><span class="punctuation section block js">{</span></span></span></span><span class="meta class js"><span class="meta block js">
  formatter = new <span class="meta function declaration js"><span class="entity name function js">Formatter</span><span class="punctuation section group begin js">(</span><span class="punctuation section group end js">)</span></span>;
<span class="punctuation section block js">}</span></span></span></span>
</span></code></pre>
<p>Just one of the many niceties that come from upgrading to Ember Octane!</p>
<p>*[POJO]: plain old JavaScript object</p>
<div class="footnote-definition" id="differences"><sup class="footnote-definition-label">1</sup>
<p>The meaningful differences between assignment and <code>defineProperty</code> only come up when you’re stomping a property via inheritance. That’s nearly always a bad idea <em>anyway</em>!</p>
</div>

                            </body>
                        </html>